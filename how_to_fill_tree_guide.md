# 🤖 Tree-LLM: LLM 기반 문단 단위 트리 생성 및 병합 가이드

이 문서는 논문을 문단 단위로 분석하여 트리 구조를 구성하고,  
그 결과들을 **LLM을 통해 병합**하여 섹션 단위 트리를 완성하는 전체 과정을 설명합니다.

---

## 🎯 목적

- 각 논문 섹션을 구조적인 트리 형태로 표현
- 각 문단을 LLM에게 입력하여 해당 문단에서 의미 있는 노드를 추출
- **LLM을 다시 활용하여** 문단별 결과를 병합하여 **최종 트리 생성**

---

## 🧱 전체 파이프라인

```
[논문 섹션 텍스트]
      ↓
[문단 단위 분리]
      ↓
[각 문단 → 트리 노드 추출 (LLM)]
      ↓
[Partial 트리 리스트 생성]
      ↓
[LLM에게 병합 요청 → 완성된 섹션 트리]
```

---

## 1️⃣ 문단 나누기

- 텍스트를 `\n\n` 또는 자연어 문단 경계 기준으로 나눕니다.

```python
paragraphs = [p.strip() for p in section_text.split("\n\n") if p.strip()]
```

---

## 2️⃣ 문단별 트리 생성 (Prompt ①: Fill)

- `prompts/fill/{section}_fill_prompt_by_paragraph.txt` 사용
- 각 문단에서 의미 있는 노드만 JSON 트리 형식으로 출력
- 예:

```json
{
  "1. Introduction": {
    "문제 정의 (Problem)": "기존 연구는 시계열 정보를 활용하지 못함.",
    "배경 설명 (Background)": "없음",
    "연구 공백 (Gap)": "시간 정보 반영 부족",
    "연구 동기 (Motivation)": "시간 인지형 접근 필요성"
  }
}
```

---

## 3️⃣ 병합 (Prompt ②: Merge)

- `prompts/merge/merge_prompt_template.txt` 사용
- 문단별 Partial Tree들을 모두 나열하여 **LLM에게 병합 요청**
- 병합 규칙은 다음과 같습니다:
  - 같은 노드가 여러 문단에 있을 경우 **더 명확한 표현**을 선택
  - 서로 보완되면 **요약하여 통합**
  - 정보가 없으면 `"없음"`으로 표기

### 🧠 예시:

```json
{
  "1. Introduction": {
    "문제 정의 (Problem)": "기존 연구는 시계열 간격 정보를 반영하지 못하고, 데이터 분포 변화에 취약함.",
    "배경 설명 (Background)": "딥러닝은 다양한 의료 진단에 활용되어 왔다.",
    "연구 공백 (Gap)": "시간 정보의 부재",
    "연구 동기 (Motivation)": "시간 인지형 모델의 필요성"
  }
}
```

---

## 🧠 LLM을 쓰는 이유?

| 기존 방식 | LLM 병합 방식 |
|------------|---------------|
| 단순 덮어쓰기 | 의미 중심 통합 |
| `"없음"` 무시하고 덮음 | 표현력 비교/요약 가능 |
| 누락, 충돌 해결 어려움 | 구체성과 맥락 기반 선택 가능 |

---
